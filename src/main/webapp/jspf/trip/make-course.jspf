<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>	
		<div class="d-flex" style="height:100vh">
			<section class="trip-sidebar-left" style="flex:1.2;">
				<div class="trip-tabs mb-3 mt-2" id="trip-loc-tab" role="tablist">
					<button class="trip-tab is-active fs-5" id="trip-tab-rcmd" role="tab" aria-selected="true" onclick="toggleLocTab(this)" >ì¶”ì²œ</button>
					<button class="trip-tab fs-5" id="trip-tab-search" role="tab" aria-selected="false" onclick="toggleLocTab(this)">ì§ì ‘ ê²€ìƒ‰</button>
					<!-- íŒŒë€ ì¸ë””ì¼€ì´í„° -->
					<span class="trip-tab-indicator"></span>
				</div>
				<form action="..." method="post" id="trip-search-form" style="display:none; " class="mt-1">
					<div style="position: relative; width: 300px;">
					  <input type="text" name="query" class="form-control"
					         placeholder="ì¥ì†Œëª…ì„ ì…ë ¥í•˜ì„¸ìš”"
					         style="padding-right: 40px;"> <!-- ë²„íŠ¼ ê³µê°„ í™•ë³´ -->
					  <button type="submit" class="btn-search"
					          style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); border: none; background: none; cursor: pointer;">
					    <i class="fa fa-search"></i>
					  </button>
					</div>
				</form>
				<div id="trip-rcmds">
				    <div class="trip-loc-tags mt-2 mb-2">
			            <span class="trip-loc-tag">ëª…ì†Œ</span>
			            <span class="trip-loc-tag">ì‹ë‹¹</span>
			            <span class="trip-loc-tag">ì¹´í˜</span>
			            <span class="trip-loc-tag">ì¹œêµ¬ ì¶”ì²œ</span>
		            </div>
		            <div style=" max-height: calc(100vh - 140px); overflow-y: auto;">
						<%@ include file="/jspf/trip/trip-loc.jspf"%>
		            </div>
				</div>
			</section>
			<!-- ì¤‘ê°„ ì¼ì • íƒ€ì„ë¼ì¸ -->
			<section class="trip-schedule" id="trip-loc" style="flex:1; overflow: hidden;">
				<div class="trip-schedule-header mb-3 d-flex justify-content-between">
					<span class="fs-3">í•˜ì™€ì´</span>
					 <small class="d-flex align-items-end" style="font-weight: normal; color: #999;">2025.9.6 - 2025.9.9</small>
				</div>
				<div class="trip-timeline">
					<div class="trip-timeline-day">
						<div class="trip-timeline-day-header mb-3">
							<!-- Tabs: ì¼ì • ì¼ì°¨ ì„ íƒ -->
							<% 
							int[] timelines = {1,3,2,4,0};
							int tripLen = timelines.length;
							%>
							<div class="trip-tabs" id="dayTabs" role="tablist" aria-label="ì¼ì°¨ ì„ íƒ">
								<%
								for (int i=1; i<=tripLen; i++){
									if (i==1){%>
										<button class="trip-tab is-active" role="tab" aria-selected="true" data-day="1" onclick="switchDay(this)"><%= i%>ì¼</button>
									<%}else{%>
										<button class="trip-tab" role="tab" aria-selected="false" data-day="<%= i%>" onclick="switchDay(this)"><%= i%>ì¼</button>
									<%}
								}%>
							
								<span class="trip-tab-indicator"></span>
							</div>
						</div>
						<div  style=" max-height: calc(100vh - 150px); overflow-y: auto;">
							
							<div class="trip-timelineForDay" data-day="1">
								<%@ include file="/jspf/trip/trip-timeline.jspf"%>
							</div>
							<div class="trip-timelineForDay" data-day="2" style="display:none">
							</div>
							<div class="trip-timelineForDay" data-day="3" style="display:none">
							</div>
							<div class="trip-timelineForDay" data-day="4" style="display:none">
							</div>
							<div class="trip-timelineForDay" data-day="5" style="display:none">
							</div>
						</div>
					</div>
				</div>
			</section>
	
			<!-- ì˜¤ë¥¸ìª½: ì§€ë„ -->
			<section class="map-container p-0" aria-label="ì§€ë„" style="flex:2.5; height:100vh;">
				<div id="rcmd-map" style="width:100%;height:100%;">

				</div>
				<button class="btn-info">ì´ìš©ë°©ë²•</button>
			</section>
		</div>
		<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=460e38b5e2a79f0329a7652a9b1836dd"></script>
		<script>
			function insertLoc(btn) {
				  const $btn   = $(btn);
				  const $next  = $btn.parent().next();              // ë¶€ëª¨ì˜ ë‹¤ìŒ í˜•ì œ
				  const title  = $.trim($next.find('.sl-name').text());
				  const type   = $.trim($next.find('.sl-type').text());
	
				  // í‘œì‹œ ì¤‘ì¸ íƒ€ì„ë¼ì¸(ë³´ì´ëŠ” ê²ƒ) ì„ íƒ â€” í•œ ê°œë§Œ ìˆë‹¤ê³  ê°€ì •
				  const $target = $('.trip-timelineForDay:visible').first();
				  $target
				  // í•„ìš” ì‹œ ì´ë¯¸ì§€ ì†ŒìŠ¤ê°€ ìˆë‹¤ë©´ ì´ë ‡ê²Œ ê°€ì ¸ì˜¤ì„¸ìš” (ì˜ˆì‹œ)
				  const img = $btn.parent().find('img').attr('src');
				  const order = $target.children().length;
	
				  if ($target.length) {
				    $target.append(getTimelineEvent(title, type, img, order+1));
				  }
				};
			
			function getTimelineEvent(title, type, img, order){
				let text = `
				<div class="trip-timeline-event d-flex flex-column">
					<div class="d-flex w-100">
						<div class="number m-1">\${order}</div>
						<div class="event-info mx-2">
							<div class="time">12:55-12:55</div>
							<div style="color: #ff7a7a;">\${type}</div>
							<div style="white-space: nowrap">\${title}</div>
							<span class="trip-note-toggle" onclick="toggleNote(this)">ğŸ“ë…¸íŠ¸ì‘ì„±</span>
						</div>
						<img src="\${img}"
							alt="í•˜ì–íŠ¸ í”Œë ˆì´ìŠ¤ ì™€ì´í‚¤í‚¤" class="event-img" />
					</div>
					<div class="trip-note-area">
						<textarea class="pe-5" placeholder="ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
						<button class="btn btn-light save-note-btn">ì™„ë£Œ</button>
					</div>
				</div>`;
				return text;
			}

		</script>
		